import requests
from bs4 import BeautifulSoup
import pandas as pd
import time
import json

MAX = 50

def url_convert(i) :
    return f'https://api.stock.naver.com/index/.VIX/price?page={i}&pageSize=10'



lists = []

for i in range(1,MAX) :
  vix = requests.get(url_convert(i))
  vix2 = BeautifulSoup(vix.text, 'lxml')
  jsons = vix2.find('p').text
  data = json.loads(jsons)
  for item in data:
    print(item["localTradedAt"][:10], item["closePrice"])
    lists.append({"date":item["localTradedAt"][:10], "close_value":item["closePrice"]})




print("---"*20)
print(lists)

df = pd.DataFrame(lists)
df.to_excel("vix_data.xlsx", index=False, engine='openpyxl')
    

# tbody = vix2.find('localTradedAt')

# print(tbody)
# #print(vix2)
